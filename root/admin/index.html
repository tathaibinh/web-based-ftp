<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="author" content="Teagan Atwater" />
    <meta name="viewport" content="initial-scale=1.0, width=device-width" />
    <link href="reset.css" rel="stylesheet" />
    <link href="style.css" rel="stylesheet" />
    <!--[if lt IE 9]><script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script><![endif]-->
    <title>FTP Control Panel</title>
    <script>
      var port = 00000; //469
      var server_running = false; //503
      // Look at how secure we are! Plz dnt hax us!
      var okUser = "admin";
      var okPassword = "password";

      function formSubmit(username, password, portNum) {
        var url = "index.html?PASS=" + username + "," + password;
        if (!portNum == 0) {
          url = url + "&STRT=" + portNum;
        }
        console.log(url);
        var xmlHttp = null;

        xmlHttp = new XMLHttpRequest();
        xmlHttp.open("GET", url, false);
        xmlHttp.send(null);
        return xmlHttp.responseText;
      }

      // Make sure all login fields are filled in before submitting
      function checkFilledLogin() {
        var u = document.forms["login"]["username"].value;
        var p = document.forms["login"]["password"].value;
        var o = document.forms["login"]["port"].value;

        if(u == null || u == "") {
          document.getElementById('error').innerHTML = "Please enter a username.";
        }
        else if(p == null || p == "") {
          document.getElementById('error').innerHTML = "Please enter a password.";
        }
        else if(o == null || o == "") {
          document.getElementById('error').innerHTML = "Please enter a port number.";
        }
        else {
          var response = formSubmit(u, p, o);
        }
      }

      // Called onload if incorrect username
      function badUsername() {
        document.getElementById('error').innerHTML = "The username you entered was incorrect.";
      }

      // Called onload if incorrect password
      function badPassword() {
        document.getElementById('error').innerHTML = "The password you entered was incorrect.";
      }

      // Called onload if invalid port number
      function badPort() {
        document.getElementById('error').innerHTML = "Please enter a valid port number.";
      }

      function printRun() {
        console.log("running");
        setTimeout(function() {
          console.log("end");
        }, 1000);
      }

      function printOff() {
        console.log("offline");
        setTimeout(function() {
          console.log("end");
        }, 1000);
      }
    </script>
  </head>
  <!-- <body <?php if($bad_username) { echo "onload='badUsername();'"; } else if($bad_password) { echo "onload='badPassword();'"; } else if($print_run) { echo "onload='printRun();'"; } else if($print_off) { echo "onload='printOff();'"; } ?>> -->
  <body>
    <section>
      <h1>FTP Control Panel</h1>
      <p>To change the FTP server, enter your administrative credentials.</p>
      <form name="login">
        <div class="half">
          <input name="username" type="text" placeholder="Username" />
        </div>
        <div class="spacer"></div>
        <div class="half">
          <input name="password" type="password" placeholder="Password" />
        </div>
        <script>
          if (server_running) {
            document.write("<input class='hide' name='port' type='number' min='1' max='25565' placeholder='Port Number' />");
            document.write("<input name='portcover' type='text' placeholder='Port Number: " + port + "' disabled />");
            document.write("<br />");
            document.write("<input type='button' value='Stop Server' onclick='checkFilledLogin()' />");
          }
          else {
            document.write("<input name='port' type='number' min='1' max='25565' placeholder='Port Number' />");
            document.write("<br />");
            document.write("<input type='button' value='Start Server' onclick='checkFilledLogin()' />");
          }
        </script>
        <br />
        <p id="error"></p>
      </form>
    </section>
  </body>
</html>